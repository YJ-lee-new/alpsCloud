<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.alps.oauth.server.mapper.BaseAuthority2ApiMapper">
    <resultMap id="BaseResultMap" type="com.alps.base.api.model.Authority2Api">
        <result column="company_id" property="companyId" jdbcType="VARCHAR"/>
        <result column="user_name" property="userName" jdbcType="VARCHAR"/>
        <result column="role_id" property="roleId" jdbcType="BIGINT"/>
        <result column="menu_id" property="menuId" jdbcType="BIGINT"/>
        <result column="api_url" property="apiUrl" jdbcType="VARCHAR"/>
    </resultMap>
    
     <select id="selectApi2List" resultMap="com.alps.oauth.server.mapper.BaseAuthority2ApiMapper.BaseResultMap">
        select c.company_id, d.user_name ,c.role_id,c.menu_id,a.api_url  from pf_api a, pf_aciton b, pf_action_ref c,sys_user d, sys_user_role f
		where a.api_id = b.api_id
		and b.action_id = c.action_id
		and c.role_id = f.role_id
		and d.user_id = f.user_id
		and a.`status` = '1'
		and b.`status` = '1'
		and c.`status` = '1'
		and d.`status` = '1'
		and d.user_name = #{userName}
    </select>
</mapper>
